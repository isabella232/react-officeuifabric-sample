---
page_type: sample
products:
- office-365
- ms-graph
languages:
- javascript
description: "В этом примере показано, как вносить в компоненты Office UI Fabric React данные, полученные из Microsoft Graph."
extensions:
  contentType: samples 
  technologies:
  - Microsoft Graph
  - Office UI Fabric
  services:
  - Office 365
  platforms:
  - React
  createdDate: 1/6/2017 9:41:30 AM
---
# Пример Microsoft Graph Office UI Fabric React

## Содержание

* [Введение](#introduction)
* [Предварительные требования](#prerequisites)
* [Регистрация приложения](#register-the-application)
* [Сборка и запуск примера](#build-and-run-the-sample)
* [Полезный код](#code-of-note)
* [Вопросы и комментарии](#questions-and-comments)
* [Участие](#contributing)
* [Дополнительные ресурсы](#additional-resources)

## Введение

Этот пример представляет собой простое приложение React, использующее данные Microsoft Graph с компонентами Office UI Fabric React (предварительная версия), преимущественно [PeoplePicker](https://dev.office.com/fabric#/components/peoplepicker) и [DetailsList](https://dev.office.com/fabric#/components/detailslist).

<img src="./readme-assets/peoplepickerexample.png" alt="Снимок экрана с примером Microsoft Graph Office UI Fabric React" width="500">

Этот пример использует [клиентскую библиотеку JavaScript для Microsoft Graph](https://github.com/microsoftgraph/msgraph-sdk-javascript) для взаимодействия с Microsoft Graph и [HelloJS](https://adodson.com/hello.js/) для проверки подлинности с [конечной точкой Azure AD версии 2.0](https://azure.microsoft.com/en-us/documentation/articles/active-directory-appmodel-v2-overview).

## Предварительные требования

Для этого примера требуются приведенные ниже компоненты.  

* [Node.js](https://nodejs.org/) Платформа Node необходима для установки зависимостей и запуска примера на сервере разработки.
* [Рабочая или учебная учетная запись](https://dev.office.com/devprogram)
  
## Регистрация приложения

1. Перейдите на страницу [регистрации приложений](https://go.microsoft.com/fwlink/?linkid=2083908) портала Microsoft Azure.

2. Выберите **Новая регистрация**.

3. После появления страницы **Регистрация приложения** введите сведения для регистрации приложения:

    * Введите имя в поле **Имя** название приложения, например `МойПримерReact`
    * В разделе **Поддерживаемые типы учетных записей** выберите вариант **Учетные записи в любом каталоге организации и личные учетные записи Майкрософт (например, Skype, Xbox, Outlook.com)**.
    * В разделе URI перенаправления (необязательно) выберите параметр **Веб** в поле со списком и введите следующий URI перенаправления: `https://localhost:3000/`.

4. Выберите **Регистрация**, чтобы создать приложение.

   Откроется страница обзора регистрации со списком свойств приложения.

5. Скопируйте **идентификатор приложения (клиента)** и запишите его. Это уникальный идентификатор приложения. Это значение будет использоваться для настройки приложения.

6. Выберите раздел **Проверка подлинности**.
    * В разделе **Дополнительные параметры** | **Неявное предоставление** установите флажок **Маркеры доступа** и **Маркеры идентификации**,
	так как для этого примера требуется включить [поток неявного предоставления](https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-implicit-grant-flow)
	для входа пользователя и вызова API.

7. Нажмите кнопку **Сохранить**.

## Сборка и запуск примера

1. Клонируйте или скачайте пример Microsoft Graph Office UI Fabric React.

2. С помощью выбранного интерфейса IDE откройте файл config.js в каталоге *src/helpers*.

3. Замените текст **applicationId** на идентификатор зарегистрированного приложения Azure.

4. Откройте окно командной строки в корневом каталоге примера и выполните следующую команду, чтобы установить зависимости проекта.

  ```
  npm install
  ```

5. После установки зависимостей выполните следующую команду, чтобы запустить сервер разработки.

  ```
  npm start
  ```

6. Введите адрес *http://localhost:3000* в веб-браузере.

7. Войдите со своей рабочей или учебной учетной записью.  

    >Примечание. Хотя конечная точка Azure AD v2.0 поддерживает вход как с личными, так и с рабочими или учебными учетными записями, в этом примере People Picker использует функции, которые поддерживаются только с рабочими или учебными учетными записями (например, конечная точка [`/me/people`](https://graph.microsoft.io/en-us/docs/api-reference/beta/api/user_list_people)).
  
8. На панели команд нажмите **Выбор компонента> People Picker** или **Выбор компонента > Details List**.

   - В примере People Picker можно отфильтровать список людей или выполнить поиск пользователей в своей организации.
  
   - В примере Details List можно выбирать элементы из списка файлов, фильтровать элементы по имени, а также дважды щелкнуть элемент, чтобы открыть его в OneDrive.

Дальнейшие действия: Попробуйте добавить в этот пример дополнительные возможности или другие компоненты или создайте собственное простое приложение, следуя [руководству по работе с Office UI Fabric React](https://github.com/OfficeDev/office-ui-fabric-react/blob/master/ghdocs/README.md).

## Полезный код

### Auth
Этот пример приложения использует [HelloJS](https://adodson.com/hello.js/) для проверки подлинности с [конечной точкой Azure AD v2.0](https://azure.microsoft.com/en-us/documentation/articles/active-directory-appmodel-v2-overview). 

 - [`App.js`](./App.js). Инициализирует настраиваемую сеть проверки подлинности Azure AD для HelloJS и предоставляет методы входа и выхода.
 
 >Важно! Приложение реализует очень простую модель проверки подлинности. Оно повторно использует маркер доступа до тех пор, пока пользователь не выйдет из системы или пока не получит ошибку 401 "Истек срок действия маркера доступа", после чего пользователь перенаправляется на метод входа. Рабочие приложения должны обеспечивать более надежную процедуру проверки подлинности и подтверждения.

### Взаимодействие с Microsoft Graph
Этот пример использует [клиентскую библиотеку JavaScript для Microsoft Graph](https://github.com/microsoftgraph/msgraph-sdk-javascript) (пакет SDK) для взаимодействия с Microsoft Graph. 

 - [`GraphSdkHelper`](./src/helpers/GraphSdkHelper.js). Использует клиента SDK для вызова Microsoft Graph и обработки ответов. 
 
 Клиент инициализируется с помощью authProvider, который получает текущий маркер доступа для каждого запроса. В этом примере используются API [User](https://graph.microsoft.io/en-us/docs/api-reference/v1.0/resources/user), [Person](https://graph.microsoft.io/en-us/docs/api-reference/beta/resources/person) (предварительная версия) и [DriveItem](https://graph.microsoft.io/en-us/docs/api-reference/v1.0/resources/driveitem).

### Компоненты и стили Fabric.
В этом примере используется несколько [компонентов Office UI Fabric React](https://dev.office.com/fabric#/components) (предварительная версия). Благодаря гибкой модели разработки Fabric можно использовать поведение компонента по умолчанию или настроить его в соответствии со своими потребностями.

 - [`App.js`](./App.js). Главная страница приложения, в которой для навигации по примерам, а также для входа в систему и выхода из нее используется компонент **CommandBar**.
 
 - [`PeoplePicker.js`](./src/component-examples/PeoplePicker.js). Пример People Picker, использующий компонент **NormalPeoplePicker** для отображения компонентов **Persona**. Также использует такие компоненты, как **Button** и **MessageBar**. 
 
 Реализация People Picker в примере работает следующим образом.
   
   - После загрузки образца PeoplePicker пример запрашивает в Microsoft Graph 20 первых совпадений людей, имеющих отношение к текущему пользователю (сначала извлекаются метаданные, а затем — фотографии профиля). Пользовательские метаданные сопоставляются с объектом **Persona**, хранящимися в массиве **_peopleList**.
   
   - При вводе текста в People Picker метод **_onFilterChanged** возвращает соответствующие результаты из списка людей, которые затем отображаются в качестве предлагаемых вариантов.
   
   - При нажатии кнопки **Поиск**, метод **_onGetMoreResults** запрашивает в Microsoft Graph первые 20 пользователей, чьи имена начинаются с текста фильтра. Результаты временно добавляются в массив "люди" для использования в методе **_onFilterChanged**.
   
   - При выборе людей или отмене выбора метод **_onSelectionChanged** обновляет локальный массив выбранных пользователей.
   
 - [`DetailsList.js`](./src/component-examples/DetailsList.js). Пример Details List, использующий компонент**DetailsList** со служебными программами **MarqueeSelection** и **Selection**. Также использует такие компоненты, как **Spinner** и **TextField**.

 Реализация Details List в примере работает следующим образом.
   
   - После загрузки образца DetailsList пример запрашивает в Microsoft Graph 100 первых элементов в корневом диске текущего пользователя. Метаданные элемента диска сопоставляются с объектами элемента списка, хранятся в массиве **_items** и сохраняются в состояние. Если результирующий набор разбит на страницы, в массив элемента добавляется пустая запись, которая инициирует запрос на следующую страницу результатов.
   
   - Когда в текстовое поле вводится текст фильтра, метод **_onFilterChanged** обновляет состояние с учетом совпадающих результатов.
   
   - При выборе элемента списка или отмене выбора вызывается метод **_getSelectionDetails**.
   
Образец также обращается к стилям Office UI Fabric Core в [`index.html`](./public/index.html).

## Устранение неполадок

| Решение | проблемы |
|:------|:------|
| Внутренние ошибки сервера для кэшированных запросов изображений в Microsoft Edge | Если вы обновите окно браузера во время работы с образцом, может появиться сообщение об ошибке HTTP 500 (Внутренняя ошибка сервера) для кэшированных запросов фотографий профиля. Чтобы устранить эту проблему, закройте вкладку примера, очистите кэш браузера и снова откройте пример. |  
| Синтаксическая ошибка в IE |Клиентская библиотека JavaScript для Microsoft Graph использует обещания ES6. Связанные PR: [microsoftgraph/msgraph-sdk-javascript#29](https://github.com/microsoftgraph/msgraph-sdk-javascript/pull/29) |

## Вопросы и комментарии

Мы будем рады узнать ваше мнение об этом примере. Вы можете отправлять нам свои вопросы и предложения на вкладке [Issues](https://github.com/microsoftgraph/react-officeuifabric-sample/issues) (Проблемы) этого репозитория.

Ваш отзыв важен для нас. Для связи с нами используйте сайт [Stack Overflow](https://stackoverflow.com/questions/tagged/microsoftgraph). Помечайте свои вопросы тегом [MicrosoftGraph].

## Участие

Если вы хотите добавить код в этот пример, просмотрите статью [CONTRIBUTING.md](CONTRIBUTING.md).

Этот проект соответствует [правилам поведения Майкрософт, касающимся обращения с открытым кодом](https://opensource.microsoft.com/codeofconduct/). Дополнительные сведения см. в разделе [вопросов и ответов о правилах поведения](https://opensource.microsoft.com/codeofconduct/faq/). Если у вас возникли вопросы или замечания, напишите нам по адресу [opencode@microsoft.com](mailto:opencode@microsoft.com).

## Дополнительные ресурсы

- [Компоненты Office UI Fabric](https://dev.office.com/fabric#/components)
- [Другие примеры кода для Microsoft Graph](https://github.com/microsoftgraph?utf8=%E2%9C%93&q=sample)
- [Общие сведения о Microsoft Graph](https://graph.microsoft.io)

## Авторские права
(c) Корпорация Майкрософт (Microsoft Corporation), 2017. Все права защищены.
